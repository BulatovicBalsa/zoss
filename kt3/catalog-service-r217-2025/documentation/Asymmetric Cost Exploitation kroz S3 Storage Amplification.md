# Eksploatacija Asymmetric Cost Exploitation kroz S3 Storage Amplification

# 1. Uvod

U okviru sistema, S3 bucket koristi se za skladištenje slika proizvoda. Upload slika se realizuje putem pre-signed URL mehanizma, čime je omogućen kontrolisan i vremenski ograničen pristup privatnom bucket-u.

Iako ovakav pristup eliminiše neautorizovani pristup skladištu, on ne sprečava ekonomski napad zasnovan na legitimnim upload operacijama.

U ovom scenariju, pretnja ne cilja podatke, već finansijsku održivost sistema.

# 2. Definisanje pretnje i napada

## 2.1 Pretnja

**Pretnja:**

> Narušavanje ekonomske održivosti sistema kroz disproporcionalno povećanje troškova skladištenja i S3 operacija.

Ova pretnja utiče na:

- S3 storage troškove  
- troškove PUT zahteva  
- potencijalne troškove replikacije i backup-a  
- dugoročnu budžetsku stabilnost sistema  

## 2.2 Napad

**Napad:** S3 Storage Amplification Attack

Napad se sastoji u tome da autorizovani akter (npr. prodavac) generiše veliki broj legitimnih upload operacija slika, unutar dozvoljenih tehničkih ograničenja.

Napadač može:

- neograniceno uploadovati fajlove maksimalno dozvoljene velicine  
- generisati veliki broj upload zahteva  
- periodično ponavljati upload operacije  

Napad eksploatiše asimetriju između:

- niskog troška iniciranja upload zahteva  
- trajnog troška skladištenja objekata u S3  

Napadač koristi dozvoljenu funkcionalnost sistema, bez kršenja autentifikacije ili autorizacije.

# 3. Opšti obrazac eksploatacije

Obrazac napada je sledeći:

1. Napadač zahteva veliki broj pre-signed upload tokena  
2. Uploaduje slike maksimalne dozvoljene veličine  
3. Objekti ostaju trajno skladišteni u bucket-u  

Ako definišemo:

- `N`: broj upload operacija  
- `S`: prosečna veličina jedne slike  
- `C_put`: trošak jednog PUT zahteva  
- `C_storage`: cena skladištenja po jedinici veličine  

Ukupan trošak sistema može se aproksimirati kao:

$$
C_{total} = N \cdot C_{put} + (N \cdot S) \cdot C_{storage}
$$

Za razliku od fan-out scenarija, ovde trošak ima trajnu komponentu skladištenja.

# 4. Identifikovana ranjivost

Ranjivost se može definisati kao:

> Nepostojanje kvantitativnog ograničenja nad brojem i ukupnom veličinom upload-ovanih objekata po nalogu.

Pre-signed URL uvodi kontrolu pristupa, ali ne uvodi ekonomsku kontrolu nad količinom resursa koji se mogu alocirati.

Sistem tretira svaku legitimnu upload operaciju kao prihvatljivu, bez obzira na kumulativni efekat.

# 5. Mitigacija napada

## 5.1 Kvota po nalogu

Uvođenje ograničenja nad:

- maksimalnim brojem slika po proizvodu  
- maksimalnim brojem slika po prodavcu  
- ukupnom veličinom skladištenja po prodavcu  

Ova kontrola se može implementirati u `presign-upload` Lambda funkciji, pre generisanja pre-signed URL-a.

## 5.2 Ograničenje veličine objekta

Pre-signed POST policy već omogućava:

- `content-length-range` limit  

Time se sprečava upload objekata većih od definisanog maksimuma.

## 5.3 Lifecycle politika

Uvođenje lifecycle pravila za:

- brisanje neaktivnih slika  
- brisanje objekata vezanih za obrisane proizvode  
- automatsko uklanjanje privremenih objekata  

Time se uklanja trajna komponenta troška.

# 6. Nova ekonomska struktura

Ako uvedemo:

- `Q`: maksimalna dozvoljena kvota (broj ili ukupna veličina)  
- `N_eff = min(N, Q)`  

Trošak postaje:

$$
C_{total} = N_{eff} \cdot C_{put} + (N_{eff} \cdot S) \cdot C_{storage}
$$

Pošto važi $N_{eff} \le Q$, napadač više ne može linearno povećavati trošak sistema iznad definisanog praga. Time se eliminiše neograničena ekonomska asimetrija.

# 7. Zaključak

S3 Storage Amplification Attack predstavlja oblik Asymmetric Cost Exploitation napada koji koristi legitimne upload operacije kako bi izazvao trajni rast infrastrukturnih troškova.

Pre-signed URL mehanizam uvodi kontrolu pristupa, ali ne eliminiše ekonomsku ranjivost sistema.

Tek uvođenjem kvota i lifecycle politika menja se ekonomska struktura sistema i uklanja osnovni mehanizam asimetrije.
