## 1. Uvod

Amazon S3 podržava multipart upload mehanizam, koji omogućava efikasan prenos velikih objekata podelom fajla na više delova (part-ova).

Multipart upload proces sastoji se iz tri faze:

1. Inicijalizacija upload sesije  
2. Upload pojedinačnih delova  
3. Finalizacija (Complete Multipart Upload)

Objekat postaje vidljiv tek nakon uspešne finalizacije.

Iako ovaj mehanizam poboljšava performanse i pouzdanost prenosa, on uvodi novu potencijalnu površinu napada ukoliko se ne kontroliše pravilno.

## 2. Definisanje pretnje i napada

### 2.1 Pretnja

**Pretnja:**

> Nekontrolisana alokacija skladišnih resursa kroz nepotpune multipart upload sesije.

Ova pretnja utiče na:

* raspoloživost skladišnog kapaciteta  
* operativne troškove  
* stabilnost sistema  

Pretnja nije vezana za kompromitaciju podataka, već za zloupotrebu legitimne funkcionalnosti S3 servisa.

### 2.2 Napad

**Napad:** Multipart Upload Abandonment

> Multipart Upload Abandonment predstavlja napad u kome napadač inicijalizuje veliki broj multipart upload sesija i uploaduje delove objekata bez njihove finalizacije.

U ovom scenariju:

* napadač započinje multipart upload  
* uploaduje jedan ili više delova  
* nikada ne poziva CompleteMultipartUpload operaciju  

Delovi ostaju skladišteni u S3 bucket-u i zauzimaju prostor, iako objekat formalno ne postoji.

Napad eksploatiše činjenicu da S3 zadržava upload delove dok se eksplicitno ne abortiraju.

## 3. Mehanizam eksploatacije

Napadač može:

1. Automatizovati inicijalizaciju velikog broja multipart upload sesija  
2. Uploadovati delove maksimalno dozvoljene velicine  
3. Izostaviti finalizaciju upload-a  

Rezultat je:

* veliki broj nepotpunih upload sesija  
* zauzimanje skladišnog prostora  
* potencijalno povećanje troškova  
* degradacija performansi  

S obzirom da su zahtevi legitimni i pravilno potpisani (npr. putem pre-signed URL mehanizma), napad ne zahteva kompromitaciju autentifikacije.

## 4. Identifikovana ranjivost

Ranjivost se može definisati kao:

> Izostanak mehanizma za automatsko uklanjanje nepotpunih multipart upload sesija.

Ukoliko sistem:

* ne prati aktivne upload sesije  
* nema lifecycle politiku  
* ne abortira stare multipart upload-e  

napadač može trajno opterećivati skladišni sloj bez završetka objekata.

Važno je naglasiti da pre-signed URL mehanizam sam po sebi ne eliminiše ovaj napad, jer potpisana dozvola omogućava legitimno iniciranje multipart sesije.

## 5. Mitigacija napada

### 5.1 Lifecycle politika za abortiranje multipart upload-a

Amazon S3 omogućava konfiguraciju lifecycle pravila:

* automatsko abortiranje nepotpunih multipart upload sesija  
* definisanje maksimalnog broja dana trajanja sesije  

Primer pravila:

- AbortIncompleteMultipartUpload nakon 1 dana

Ovim mehanizmom:

* svi nepotpuni upload-i se automatski uklanjaju  
* skladišni prostor se oslobađa  
* smanjuje se rizik zloupotrebe  

### 5.2 Ograničavanje maksimalne veličine objekta

Pre-signed policy može definisati:

* maksimalnu dozvoljenu veličinu fajla  
* ograničenja po Content-Type-u  

Ovo smanjuje potencijalni uticaj napada, ali ne eliminiše potrebu za lifecycle pravilima.

### 5.3 Monitoring i audit

Preporučene dodatne mere:

* CloudWatch metrika za broj aktivnih multipart upload sesija  
* Periodično listanje i abortiranje zastarelih upload-a  
* Alarmiranje na neuobičajeno veliki broj započetih upload sesija  

## 6. Efekat mitigacije

Primena lifecycle pravila i monitoringa:

* uklanja dugotrajnu alokaciju skladišnog prostora  
* smanjuje operativni rizik  
* ograničava potencijalne troškove  

Time se skladišni sloj štiti od zloupotrebe legitimne multipart funkcionalnosti.

## 7. Zaključak

Multipart Upload Abandonment napad predstavlja primer zloupotrebe legitimne funkcionalnosti S3 servisa.

Napad ne kompromituje podatke niti pristupne kontrole, ali može dovesti do:

* degradacije raspoloživosti  
* povećanja troškova  
* infrastrukturne nestabilnosti  

Pre-signed URL mehanizam ne eliminiše ovaj napad, te je neophodno primeniti dodatne zaštitne mehanizme, prvenstveno lifecycle pravila za automatsko abortiranje nepotpunih upload sesija.

Na taj način se obezbeđuje dugoročna stabilnost skladišnog sloja.
